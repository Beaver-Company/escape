name: escape-client
version: 0.18.@
description: |
  The Escape Client. This release includes the source and one binary for
  Linux/AMD64.  For full documentation see http://escape.ankyra.io/

logo: logo.png

depends:
- escape-core-latest as core

includes:
- escape
- LICENSE
- README.md
- Makefile
- main.go
- cmd/
- controllers/
- model/
- util/
- vendor/
- godog/
- docs/

errands:
  publish_binaries:
    description: Create binaries for all platforms and upload to a GCS bucket
    inputs:
    - description: The target bucket
      id: bucket
    - description: Service account credentials
      id: credentials
    - default: $this.version
      id: escape_version
    script: scripts/publish-binaries.sh
  upload_to_gcs:
    description: Upload the produced linux/amd64 binary to a GCS bucket
    inputs:
    - description: The target bucket
      id: bucket
    - description: Service account credentials
      id: credentials
    - default: $this.version
      id: escape_version
    script: scripts/upload_to_gcs.sh

templates:
- file: util/metadata.go.tpl
  mapping:
    version: $this.version

build: scripts/build.sh
test: scripts/test.sh
